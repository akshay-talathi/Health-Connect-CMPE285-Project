<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title>Add/Show Traffic Layer</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
      <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
      <script type="text/javascript">
      var map = null;
      function trafficModuleLoaded()
      {
        setMapView();
      }    
       function loadTrafficModule()
      {
       Microsoft.Maps.loadModule('Microsoft.Maps.Traffic', { callback: trafficModuleLoaded });
      }
      function setMapView()
      {
        map.setView({zoom: 10, center: new Microsoft.Maps.Location(40.73, -73.98)})
      }            
      function getMap()
      {
          map = new Microsoft.Maps.Map(document.getElementById('myMap'), {credentials: 'Your Bing Maps Key'});
          loadTrafficModule();
      }   
      function showTrafficLayer()
      {
        
        var trafficLayer = new Microsoft.Maps.Traffic.TrafficLayer(map);
        // show the traffic Layer
        trafficLayer.show();
      }
      </script>
   </head>
 <body onload="getMap();">
      <div id='myMap' style="position:relative; width:400px; height:400px;"></div>
      <div>
         <input type="button" value="ShowTrafficLayer" onclick="showTrafficLayer();" />
      </div>
      <div id='output'> </div> 
   </body>
</html>